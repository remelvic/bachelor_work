# Message Broker

## Что такое брокер сообщений ?

Брокер сообщений это часть приложения которая занимается обменом сообщений между сервисами. Он помогает снять нагрузку с веб-сервиса, т.к. он не занимается пересылкой сообщений. Обмен сообщениями происходит асинхронно, что позволяет одному сервису отправить запрос брокеру сообщений, а брокер сообщений гарантирует, что сообщение бдует доставлено второму сервису. Это позволит первому сервису не ждать ответа от второго сервиса и позволит пользователю дальше пользоваться приложением без ожидания. Брокер сообщений гарантирует доставку данных от сервиса к сервису. 

Брокер сообщений представляет собой модель Producent - Konzument: _Producent_ публикует новые события в группе по определенным аттрибутам. _Konzument_ подписывается на эти события с определенным аттрибутам и обробатывает их.

## Apache Kafka
Отдельный сервер Kafka называется брокеро. Брокер получает сообщение от продуцера, присваивает им офсеты и отправляет их в дисковое хранилище.

Физические данные в Kafka хранятся на диске в виде секций (partitions). Сообщения хранятся в секциях под индексом (offset). 

Producent и Konzument указываю топик, на который они подписываются. Сообщение из одного топика может храниться в разных секциях. Consumer сам делает запрос брокеру, посылая ему номер сообщения и номер секции и он Cosumer получает данные 

<!-- Производители, формируя сообщения, прикрепляют к нему ключ и номер партиции. Номер партиции может быть выбран рандомно (round-robin), если у сообщения отсутствует ключ. -->

 
 ### Notes
 Брокеры полезны тогда, когда какие-либо действия для своего выполнения требуют много времени, потребляют много ресурсов и __НЕ__ требуют немедленного результата. Так же они упрощают координацию в микросервисной архитектуре 